<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe PageMill 3.0 Win">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<TITLE>BADC Datasets: MIDAS - CEDA WPS User Guide</TITLE>
<!-- Created 21th July 2011 -->
<!-- Author: Anabelle Guillory BADC-->
</HEAD>
<BODY BGCOLOR="#ffffff">

<H1>CEDA WPS User Guide for extracting MIDAS data and metadata, as well as other CEDA datasets</H1>

<HR ALIGN=LEFT>
<strong>User Guide content</strong>
<ul>
<li><a href="WPS.html#things">Things to know before using the WPS</a>
<LI><a href="WPS.html#extract">Extracting MIDAS data via the WPS</a>
<ul>
<li><a href="WPS.html#homepage">About the CEDA WPS Home page</a>
<li><a href="WPS.html#procedure">Procedure to extract MIDAS data or a station via CEDA WPS</a>
<ol>
<li><a href="WPS.html#login">Login</a>
<li><a href="WPS.html#job">Submit a job</a>
<ul>
<li><a href="WPS.html#sectionA">Section A: <em>ExtractUKStationData</em></a> or how to submit a job to extract MIDAS UK station data
<li><a href="WPS.html#sectionB">Section B: <em>GetWeatherStations</em></a> or how to submit a job to generate a MIDAS station list
</ul>
</ol>
</ul>     
<li><a href="WPS.html#hadisst">Extracting other CEDA datasets using the WPS Subsetter Process</a>

<li><a href="WPS.html#download">Download the job outputs</a>
<li><a href="WPS.html#logout">Logout</a>

<li><a href="WPS.html#c">Who to Contact</a>

</ul>
<hr>

<p>
The data for each of the MIDAS data types is stored in the <a href="http://data.ceda.ac.uk/badc/ukmo-midas/data/">Met Office MIDAS Surface data directories</a> in yearly files. These files are large and as a result can be difficult to work with.
The <a href="http://wps-web1.ceda.ac.uk/ui/home">CEDA WPS</a> is available for your use, so that you can extract data and metadata from specific areas. 
<P>



<H2><a name="things"></a>Things to know before using the WPS</H2>

<ul>
<li><strong>Access restrictions:</strong>
<p>In order to use the CEDA WPS, you must be registered with the BADC (new users should register <a href="https://services.ceda.ac.uk/cedasite/register/info/">here</a>). In addition to this, to access selected processes (e.g. MIDAS, HadISST), registered users must also be granted access to the dataset by completing the online application (for MIDAS, the online application is available <a href="https://services.ceda.ac.uk/cedasite/resreg/application?attributeid=surface">here</a>. If you have forgotten your password, please email <a href="http://www.ceda.ac.uk/contact/">CEDA Support</a>.
<p>
<li><strong>WPS Data Output files availability:</strong>
<p>The extracted data will be available through the WPS.
<!--and also copied as ascii files to your Requested Data (Requests) directory, which you can access through the link on your <a href="http://badc.nerc.ac.uk/mybadc/">My BADC</a> webpage. 
-->

<li> <strong>WPS Data Output file format and units:</strong>
<p>The format and units are as outlined in the <a href="index.html#DataTables">tables information</a>.
<p>
<a href="../../web_guides/csv_to_excel_demo_skin.swf" alt="view guide" target="blank"><img border="0" align="absmiddle" src="/graphics/logos/small/wgclapper_icon.png" alt="How to import a text file to Excel">Web Guide on How to import a text file to Excel</a>.<br> If you intend to import the text file into Excel, please remember that MS Excel is limited to 65,536 rows of data. If the data file is too large, data
will be cropped to fit. Use MS Access if you need to open a large file.
<p>
<li><strong>How to find MIDAS Weather stations:</strong>
<p>
<ul>
<li><a href="../../web_guides/midas_find1_demo_skin.swf" alt="view guide" target="blank">
<img border="0" align="absmiddle" src="/graphics/logos/small/wgclapper_icon.png" alt="How to find a weather station">Webguide on How to find a weather station</a> 

<li><a href="../../web_guides/midas_find2_demo_skin.swf" alt="view guide" target="blank"><img border="0" align="absmiddle" src="/graphics/logos/small/wgclapper_icon.png" alt="Using the Interactive map">Webguide on how to use the Interactive Map to find a weather station</a>

<li><a href="http://archive.ceda.ac.uk/midas_stations/">Use the MIDAS station search engine</a> to find stations and make a note of their src_ids or copy them to clipboard.

<li>You can also use the WPS to generate a list of stations matching your selection criteria (GetWeatherStations WPS process). You can then use the generated list to extract the associated MIDAS data via the WPS. More details below.
</ul>

<p>
<li> <strong>The MIDAS database is downloaded monthly from the Met Office to the BADC</strong>. The most recent available data for most tables will be for the previous month.

<p>
<li><strong>Browser compatibility:</strong>
<p>
The CEDA WPS has been tested with the following browsers:
<ul>
<li>    Firefox 3+
<li>    Chrome 10+
<li>    Internet Explorer 8
</ul>
<p>If you test the CEDA WPS in other browsers and it works, please let <a href="http://www.ceda.ac.uk/contact/">CEDA Support</a> know.
<P><strong>Update 31/03/2014:</strong> Some issues have been reported using the WPS in the latest versions of Chrome and Internet Explorer. We recommend that you use Firefox.
<p>
<li><strong>Bugs and future developments:</strong>
<p>If you discover a problem with the CEDA WPS service please notify <a href="http://www.ceda.ac.uk">CEDA Support</a>. 
When reporting a problem please include the following information:
<ul>
<li>The browser you use (please include the browser version).
<li>The page the bug occurred on. Give the title of the page as it appears in the browser window title.
<li>The nature of the problem.
<li>Any error messages. 
</ul>
<p>Please note that the CEDA WPS service is continuously being developed. The following list gives the improvements that will be made in the future:
<ul>
<li>availability of output files via the BADC user requested data area
<li>reset button on BBox map
        <li>Providing links to user guides for each process on the job submission page
<li>Providing long names  for options on submission form (such as .Hourly Weather. instead of .WH.)
        <li>Allow users to submit multiple requests by pasting in WPS request URLs directly (without using the submission form) - this could be very handy for users who need to do repeat requests when only changing the date (or some other parameter).
        </ul>
        <p>
        If you think anything should be added to the list, please contact <a href="http://www.ceda.ac.uk/contact/">CEDA Support</a>.

        </UL>


        <H2><a name="extract"></a>Extracting MIDAS Data via the WPS</H2>


        Follow this link to the <a href="http://ceda-wps2.badc.rl.ac.uk/ui/home">CEDA WPS Home page</a>. 

        <P><h3><a name="homepage"></a>About the CEDA WPS Home page</h3>

        <CENTER>
        <img src="WPS_homepage.JPG" alt="CEDA WPS Homepage">
        </CENTER>

        <p>On the home page, you can find summaries briefly highlighting what CEDA WPS is, What it can do, How to run a process, how to view jobs and outputs and how to cancel a job. 
        <p>Also on this front page and available throughout all CEDA WPS website pages is the top menu bar with direct links to Home, Processes, Jobs, Login as well as News. You can also find a contact link on this menu bar on the right-hand side.

        <p>CEDA WPS can be used to extract MIDAS data for one or more weather stations at a time (<em>ExtractUKStationData</em> process). Choose to extract data for a whole county, area or individual named station(s), by src_id. 
        <p>The WPS can also be used to generate a list of stations (<em>GetWeatherStations</em> process).

        <p>Note that all job processes currently available under the WPS are detailed under the "Processes" in the top menu bar (left side). As the service develops, additional processes will be described on this "Processes" page.

        <p><h3><a name="procedure"></a>Procedure to extract MIDAS data or a station list via CEDA WPS:</h3>
        <P>
        The procedure is straightforward and in 4 steps, as follows:
        <ol>
        <li><a href="WPS.html#login">login</a>
        <li><a href="WPS.html#job">How to submit a job (select, configure and submit your process)</a>
        <li><a href="WPS.html#download">download the job outputs</a>
        <li><a href="WPS.html#logout">logout</a>
        </ol>
        <p>Details to successfully complete each step in this procedure are given below.
        <P>
        <OL>
        <li><h4><a name="login"</a>Login</h4>
        <ol>
        <li>click on the login link in the top menu bar.
        <li>Enter your Open-ID, immediately after the last forward slash (Note that open-ID and BADC account name are different. If you don't know your Open-ID or you don't remember it, then you can find it on your <a href="https://services.ceda.ac.uk/cedasite/myceda/user">MyBADC</a> page).
        <li>If you reach the BADC login page, please enter your BADC credentials (i.e. account name and associated password).
        <li>On the next screen, please click on "yes"
        <li>You should now be logged in and in the top menu bar, you should now see your OpenID and a link to "logout"
        </ol>
        <p>

        <li><h4><a name=job></a>Submit a job</h4>

        <p>To start submiting a job to extract some data via the WPS, follow the link to "Processes" on the top menu bar.

        <p>At this stage, you can either scroll down the page until you find the job process of interest or you can filter the list by entering a keyword (e.g. station to find the 2 job processes associated to the MIDAS data: ExtractUKStationData to extract MIDAS data (as explained below in <a href="WPS.html#sectionA">Section A</a>) or GetWeatherStations to generate a stations list (see <a href="WPS.html#sectionB">Section B</a> below for details).


                        <h3><a name="sectionA">Section A:</a> <em>ExtractUKStationData</em> or How to submit a job to extract MIDAS UK station data:</h3>

                        <oL>
                        <li>select job process of interest:<br>
                        Simply click on the job process title bar or follow the link to "submit a request" on the job process title bar.
                        <br>Note that if you are not already logged in, you will be asked to login at this stage.

                        <p>
                        <li>Define your inputs page:<br>
                        You shoud now see a page entitled "Define your inputs". This is the page where your define your criteria to extract the data of interest.

                        Fields to be defined are:<p>

                        <ul>
                        <li>startdatetime - the starting date from which you need the data.
                        <li>enddatetime - the end date of your time period of interest 
                        <li>outputtimechunk - either decade, year or month. Depending on your selection, your job outputs files will be 1 file per decade, 1 file per year or 1 file per month.
                        <p>
        <LI>Then you should choose to define <b>only ONE of the following options</b>:
        <ul>
        <li>BBOX:  Either enter latitude and longitude details for the individual station or for a bounding box surround
ing the location you interested in <b><u>OR</u></b> draw a bounding box (only UK areas at present) 
        <li><b><u>OR</u></b> County: Select the county(ies) that you want data for 
        <li><b><u>OR</u></b> Station ID: Enter the src_id(s) for the station(s) you are interested in - these you will have obtained through the MIDAS station
        search. Put a space between src_ids if wanting more than one (Firefox users may get an error message such as "You have submitted an invalid umput, please try again. The StationIDs input must include text characters" - this should be ignored while we are fixing this issue)
        <li><b><u>OR</u></b> Station file: For the time being, this option can only be used in conjonction with the GetWeatherStations job process and will automatically be filled in. 
        </ul>
        <p>Please note that the Station ID field value overrides the BBOX and County fields.
        <p>
        <li>Obs Table Name: Select the MIDAS table name from the drop-down list:
        <UL>
        <LI>TD - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/TD_Table.html">daily temperature table</a>
        <LI>WD - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/WD_Table.html">daily weather table</a>
        <LI>RD - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/RD_Table.html">daily rain table</a>
        <LI>RH - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/RH_Table.html">hourly rain table</a>
        <LI>RS - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/RS_Table.html">sub-hourly rain table</a>
        <LI>ST - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/ST_Table.html">soil temperature table</a>
        <LI>WH - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/WH_Table.html">hourly weather table</a>
        <LI>WM - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/WM_Table.html">mean wind table</a>
        <LI>RO - <a href="http://artefacts.ceda.ac.uk/badc_datadocs/ukmo-midas/RO_Table.html">radiation table</a>
        </UL>
        <p>
        <li>Delimiter: Comma or tab
        <p>
        <li>Then click on the Submit button. 
        </ul>
        <p>
        <li>Information about your asynchronous job
        <br>You should now see a page which gives you details about your job (Information about your asynchronous job page) and in particular the estimated duration and estimated volume. 
        Click on the Submit button to run the job and extract the data as per your request. Upon submitting your job, the server will be contacted and you should then see a monitoring page with your job details (Job: job id number page). 
        <P>
        <li>Monitoring your job: job id number page
        As your job is running on the server, the monitoring page shows your job details, and eventually below the job details, your job output files will be listed (you should see a link to download a zip file containing all the text/csv files listed below). Note that the job id page will continue to poll offline jobs when they are running unless you click the "stop polling" option when it is visible. 

        <P>IMPORTANT NOTE: Immediately after you have confirmed to run your job (after step 3), you can either log out or submit another job while the job you just submitted is running. At this point, your job has been submitted to run offline on the server. Please note that offline jobs are scheduled and may take a long time to run. You will receive an e-mail when your offline job has run so you do not need to stay on this page i.e. you may submit additional jobs. Note that you can view all previous jobs and the status of those jobs currently running on the Jobs page (link on the menu bar). This page lists all the jobs (in the lower part) you have submitted to the WPS. The upper part of the page allows you to quickly find a specific job.
        <p>

        </OL> 
        <p>

        <h3><a name="sectionB">Section B:</a> <em>GetWeatherStations</em> or How to submit a job to generate a MIDAS station list</h3> 


        <P>The GetWeatherStations process allows you to generate a list of matching stations (station numbers refered to as SRC_ID in MIDAS)  upon selecting various parameters e.g. station opening and closure times (start and end times), within a specific geographical area as defined by coordinates (BBox), or within selected counties and by DataTypes (refered to as ID types in MIDAS) , e.g. RAIN for all raingauge stations.
        <P>
        Please note that BBox, Counties and Data Types are optional selections.
        <P>
        Once the station list has been extracted, you will have the option of using the generated station list to extract associated weather data via the ExtractUKStationData process.
        <P>
        <ol>
        <li>select job process of interest:<br>
        On the "Processes" page, either scroll down the page to find and select "GetWeatherStations" or filter the listing with keyword station. Then click on the job process title bar or follow the link to "Submit a request".
        <br>Note that if you are not already logged in, you will be asked to login at this stage.

        <p>
        <li>Define your inputs page:<br>
        You shoud now see a page entitled "Define your inputs". This is the page where your define your criteria to extract the data of interest.

        Fields to be defined are:<p>

        <ul>
        <li>startdatetime - the starting date from which you need the matching station list.
        <li>enddatetime - the end date of your time period of interest 
        </ul>

        <p>Optional fields are:<p>
        <ul>
        <li>BBOX:  Either enter latitude and longitude details for the individual station or for a bounding box surround
        ing the location you interested in <b>OR</b> draw a bounding box (only UK areas at present) <b>OR</b> Counties: Select the county(ies) that you want data for.  
        <p>
        <li>DataTypes: Select the DataType from the drop-down list (optional):
                <UL>
                 <LI>CLBD
                 <LI>CLBN
                 <LI>CLBR
                 <LI>CLBW
        <LI><a href="ukmo_guide.html#dcnn">DCNN</a>
                 <LI>FIXD (Fixed station)
        <LI><a href="ukmo_guide.html#dcnn">ICAO</a>
                 <LI>LPMS (Long Period Met Station)
        <LI><a href="ukmo_guide.html#rain">RAIN</a>
                 <LI>SHIP (Marine Surface Obsrvations)
                 <LI><a href="ukmo_guide.html#rain">WIND</a>
                 <LI><a href="ukmo_guide.html#wmo">WMO</a>
                 </UL>
                 <p>
                 <li>Then click on the Submit button. 
                 </ul>
                 <p>
                 <li>Information about your asynchronous job
                 <br>You should now see a page which gives you details about your job (Information about your asynchronous job page) and in particular the estimated duration and estimated volume. 
                 Click on the Submit button to run the job and extract the data as per your request. Upon submitting your job, the server will be contacted and you should then see a job monitoring page with your job details (Job: job id number page) and eventually your output files below the job details. At this stage, your job is running asynchronously so you may log out or submit another data extraction job. You will receive an e-mail when your offline job has run. Note that you can view all previous jobs and the status of those jobs currently running on the Jobs page (link on the menu bar). This page lists all the jobs (in the lower part) you have submitted to the WPS. The upper part of the page allows you to quickly find a specific job. 
                 <P>
                 <strong>To cancel a job after having submitted it </strong>, you may either follow the link to "cancel this job" on the server polling page or you can follow the link to "cancel this job" from the Jobs details page (in the table "action" clolumn). Please note that you should only click once and wait to see a confirmation message on screen. You may experience a delay between the time you click on the Cancel link and the display of the confirmation message on screen. Then hit the back button and go to Jobs. The STATUS of your job should now show as "FAILED".            
                 <P>
                 <b><u>IMPORTANT NOTE:</u></b> Under the View job info/Outputs page, under the job details section - Job Capabilities, you are given the option to use the station list to extract the associated UK weather data. Simply follow the link which will take you to the ExtractUKStationWeather job process selection page and make your selection as explained in Section A above.

                 <P>
                 </ol>

                 <li><h4><a name="hadisst">Extracting other CEDA Datasets using the Subsetter Process</a></h4>

                 Under the Processeses tab, you will find a list of processes available including the "Subsetter process".
                 <P>
                 The Subsetter process is a subsetting tool that allows the extraction of variable subsets from a range of datasets. The user can select a dataset, a single variable, time range and bounding box. The output format can also be selected (NetCDF or CSV) along with instructions on how to divide output files into sensible time chunks. The tool uses CDAT's CDMS (Climate Data Management System) libraries to interact with the datasets in the archives. The extraction jobs run on the batch processing servers and the user is e-mailed when the job has completed.
                 <P>Datasets currently available under the Subsetter Process are:
                 <UL>
                 <LI><a href="http://artefacts.ceda.ac.uk/badc_datadocs/assim/">Met Office Stratospheric Assimilated Data</a>
                 <LI><a href="http://catalogue.ceda.ac.uk/uuid/facafa2ae494597166217a9121a62d3c">Met Office HadISST1.1 data</a>
                 <LI><A href="http://catalogue.ceda.ac.uk/uuid/00f58d1d7b6c8f38993e77c79e72da92">ECMWF) Re-Analysis Interim (ERA-Inrerim) model data</a>
                 <LI><A href="http://catalogue.ceda.ac.uk/uuid/ac4ecbd554d0dd52a9b575d9666dc42d">CRU TS3.21: Time-Series of High Resolution Gridded Data of Month-by-month Variation in Climate (Jan. 1901- Dec. 2012)</a>
</UL>
<P>Full documentation on the Subsetter tool is available at: <a href="http://wps-web1.ceda.ac.uk/docs/cows_wps/supported_procs/subsetter_process.html">http://wps-web1.ceda.ac.uk/docs/cows_wps/supported_procs/subsetter_process.html</a>

<li><h4><a name="download"></a>Download the job outputs</h4>
You will receive an e-mail when your offline job has run. To find your job outputs, either follow the link provided in the email message or go to Jobs (top menu bar).  This page lists all the jobs (in the lower part) you have submitted to the WPS. The upper part of the page allows you to quickly find a specific job. To find your job outputs, follow the job associated link to View job info/outputs. The View job info/outputs displays the job details in the upper part and list the output files in the lower part of the page.  

<li><h4><a name="logout"></a>Logout:</h4> Once you have submitted all your data extraction jobs, you should logout by simply clicking on the logout link on the top menu bar.
</ul>
<P>
            <H2><a name="contact"></a>Who to Contact</H2>
            <P>The WPS is still work in progress. If you have queries about it or about obtaining the MIDAS surface stations data from the BADC then you should contact <A HREF="http://www.ceda.ac.uk/contact">CEDA Support</A>. Your query should be answered within one working day. When follow-up work is required, the CEDA Support will carry out the work as quickly and efficiently as possible, and in any case, the user will be kept informed of
            progress.

            <P>
           
            </BODY>
            </HTML>